<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2>
      <i class="fas fa-edit me-2"></i>
      Edit Ingredient
    </h2>
    <button class="btn btn-outline-secondary" routerLink="/ingredients">
      <i class="fas fa-arrow-left me-2"></i>Back to List
    </button>
  </div>

  <div class="card shadow-sm">
    <div class="card-body">
      <form [formGroup]="ingredientForm" (ngSubmit)="onSubmit()">
        <div class="row">
          <div class="col-md-6 mb-3">
            <label class="form-label">
              <i class="fas fa-tag me-2"></i>Name
            </label>
            <input 
              type="text" 
              class="form-control" 
              formControlName="name"
              [class.is-invalid]="ingredientForm.get('name')?.invalid && ingredientForm.get('name')?.touched"
            >
            <div class="invalid-feedback">Name is required</div>
          </div>

          <div class="col-md-3 mb-3">
            <label class="form-label">
              <i class="fas fa-balance-scale me-2"></i>Quantity
            </label>
            <input 
              type="number" 
              class="form-control" 
              formControlName="quantity"
              [class.is-invalid]="ingredientForm.get('quantity')?.invalid && ingredientForm.get('quantity')?.touched"
            >
            <div class="invalid-feedback">Valid quantity is required</div>
          </div>

          <div class="col-md-3 mb-3">
            <label class="form-label">
              <i class="fas fa-ruler me-2"></i>Unit
            </label>
            <select 
              class="form-select"
              formControlName="unit"
              [class.is-invalid]="ingredientForm.get('unit')?.invalid && ingredientForm.get('unit')?.touched"
            >
              <option value="">Select Unit</option>
              <option *ngFor="let unit of units" [value]="unit">{{ unitLabels[unit] }}</option>
            </select>
            <div class="invalid-feedback">Unit is required</div>
          </div>

          <div class="col-md-4 mb-3">
            <label class="form-label">
              <i class="fas fa-dollar-sign me-2"></i>Unit Cost
            </label>
            <input 
              type="number" 
              class="form-control" 
              formControlName="unitCost"
              step="0.01"
              [class.is-invalid]="ingredientForm.get('unitCost')?.invalid && ingredientForm.get('unitCost')?.touched"
            >
            <div class="invalid-feedback">Valid unit cost is required</div>
          </div>

          <div class="col-md-4 mb-3">
            <label class="form-label">
              <i class="fas fa-th-list me-2"></i>Category
            </label>
            <select 
              class="form-select"
              formControlName="category"
              [class.is-invalid]="ingredientForm.get('category')?.invalid && ingredientForm.get('category')?.touched"
            >
              <option value="">Select Category</option>
              <option *ngFor="let category of categories" [value]="category">{{ categoryLabels[category] }}</option>
            </select>
            <div class="invalid-feedback">Category is required</div>
          </div>

          <div class="col-md-4 mb-3">
            <label class="form-label">
              <i class="fas fa-truck me-2"></i>Supplier
            </label>
            <select 
              class="form-select"
              formControlName="supplierId"
              [class.is-invalid]="ingredientForm.get('supplierId')?.invalid && ingredientForm.get('supplierId')?.touched"
            >
              <option value="">Select Supplier</option>
              <option *ngFor="let supplier of suppliers" [value]="supplier.id">
                {{supplier.name}}
              </option>
            </select>
            <div class="invalid-feedback">Supplier is required</div>
          </div>

          <div class="col-md-4 mb-3">
            <label class="form-label">
              <i class="fas fa-calendar-plus me-2"></i>Purchase Date
            </label>
            <input 
              type="date" 
              class="form-control" 
              formControlName="purchaseDate"
              [class.is-invalid]="ingredientForm.get('purchaseDate')?.invalid && ingredientForm.get('purchaseDate')?.touched"
            >
            <div class="invalid-feedback">Purchase date is required</div>
          </div>

          <div class="col-md-4 mb-3">
            <label class="form-label">
              <i class="fas fa-calendar-times me-2"></i>Expiry Date
            </label>
            <input 
              type="date" 
              class="form-control" 
              formControlName="expiryDate"
              [class.is-invalid]="ingredientForm.get('expiryDate')?.invalid && ingredientForm.get('expiryDate')?.touched"
            >
            <div class="invalid-feedback">Expiry date is required</div>
          </div>

          <div class="col-md-4 mb-3">
            <label class="form-label">
              <i class="fas fa-sort-numeric-down me-2"></i>Reorder Level
            </label>
            <input 
              type="number" 
              class="form-control" 
              formControlName="reorderLevel"
              [class.is-invalid]="ingredientForm.get('reorderLevel')?.invalid && ingredientForm.get('reorderLevel')?.touched"
            >
            <div class="invalid-feedback">Valid reorder level is required</div>
          </div>

          <div class="col-12 mb-3">
            <div class="form-check">
              <input 
                type="checkbox" 
                class="form-check-input" 
                formControlName="isPerishable"
                id="isPerishable"
              >
              <label class="form-check-label" for="isPerishable">
                <i class="fas fa-exclamation-triangle me-2"></i>Is Perishable
              </label>
            </div>
          </div>
        </div>

        <div class="d-flex justify-content-end gap-2 mt-4">
          <button type="button" class="btn btn-outline-secondary" routerLink="/ingredients">
            <i class="fas fa-times me-2"></i>Cancel
          </button>
          <button type="submit" class="btn btn-primary">
            <i class="fas fa-save me-2"></i>Update Ingredient
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<ngx-spinner
  bdColor="rgba(0, 0, 0, 0.8)"
  size="medium"
  color="#fff"
  type="ball-clip-rotate"
  [fullScreen]="true"
>
  <p style="color: white">Loading...</p>
</ngx-spinner>